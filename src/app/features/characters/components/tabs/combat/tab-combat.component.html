<div class="wrap">
  <div class="left">
    <div class="actions">
      <button type="button" class="add-btn" (click)="openAddCombat()">+ Nova tecnica combate</button>
    </div>
    <mat-card>
      <mat-card-title>Tecnicas Basicas</mat-card-title>
      <mat-card-content>
        <table class="tbl">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Nivel</th>
              <th>Custo</th>
              <th>Ajuste</th>
              <th>Total</th>
              <th>Categoria</th>
            </tr>
          </thead>
          <tbody>
            @for (i of basicas(); track i.id) {
              <tr>
                <td>{{i.name}}</td>
                <td>{{levelOf(i.id)}}</td>
                <td>{{i.cost ?? 0}}</td>
                <td>{{(i.attributeCode ?? '').toUpperCase()}}</td>
                <td>{{totalOf(i)}}</td>
                <td>{{categoryName(i.categoryId)}}</td>
              </tr>
            }
          </tbody>
        </table>
      </mat-card-content>
    </mat-card>
  </div>

  <div class="center">
    <mat-card>
      <mat-card-title>Tecnicas da Especializacao</mat-card-title>
      <mat-card-content>
        <table class="tbl">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Nivel</th>
              <th>Custo</th>
              <th>Ajuste</th>
              <th>Total</th>
              <th>Categoria</th>
            </tr>
          </thead>
          <tbody>
            @for (i of especializacao(); track i.id) {
              <tr>
                <td>{{i.name}}</td>
                <td>{{levelOf(i.id)}}</td>
                <td>{{i.cost ?? 0}}</td>
                <td>{{(i.attributeCode ?? '').toUpperCase()}}</td>
                <td>{{totalOf(i)}}</td>
                <td>{{categoryName(i.categoryId)}}</td>
              </tr>
            }
          </tbody>
        </table>
      </mat-card-content>
    </mat-card>
  </div>

  <div class="right">
    <mat-card>
      <mat-card-title>Tecnicas da Profissao</mat-card-title>
      <mat-card-content>
        <table class="tbl">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Nivel</th>
              <th>Custo</th>
              <th>Ajuste</th>
              <th>Total</th>
              <th>Categoria</th>
            </tr>
          </thead>
          <tbody>
            @for (i of restritas(); track i.id) {
              <tr>
                <td>{{i.name}}</td>
                <td>{{levelOf(i.id)}}</td>
                <td>{{i.cost ?? 0}}</td>
                <td>{{(i.attributeCode ?? '').toUpperCase()}}</td>
                <td>{{totalOf(i)}}</td>
                <td>{{categoryName(i.categoryId)}}</td>
              </tr>
            }
          </tbody>
        </table>
      </mat-card-content>
    </mat-card>
  </div>

  @if (addCombatOpen()) {
    <div class="modal-backdrop" (click)="closeAddCombat()">
      <div class="modal" (click)="$event.stopPropagation()">
        <h3>Nova tecnica combate</h3>
        <label class="field">
          <span>Tecnica basica</span>
          <select [value]="selectedCombatId() ?? ''" (change)="selectedCombatId.set($any($event.target).value ? +$any($event.target).value : null)">
            @for (t of availableBasicTechniques(); track t.id) {
              <option [value]="t.id">{{t.name}}</option>
            }
          </select>
        </label>
        <label class="field">
          <span>Nivel</span>
          <input type="number" min="0" [value]="newCombatLevel()" (input)="newCombatLevel.set(+$any($event.target).value)" />
        </label>
        <div class="modal-actions">
          <button type="button" class="ghost-btn" (click)="closeAddCombat()">Cancelar</button>
          <button type="button" class="primary-btn" (click)="saveCombat()" [disabled]="!selectedCombatId()">Salvar</button>
        </div>
      </div>
    </div>
  }
</div>
